<html lang="en">
<head>
    <title>MyWallapop Cliente jQuery</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/js/cookie.js"></script>
</head>
<body>

<!-- Barra de Navegación superior -->
<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav" id="barra-menu">
                <li><a onclick=mostrarOfertasAPI()>Ofertas disponibles</a></li>
                <!-- <li><a onclick="mostrarConversaciones()" id="conver">Conversaciones</a></li> -->
                <li><a id="ofertados" onclick=mostrarMisOfertas()>Mis ofertas</a></li>
            </ul>
            <!--
            <ul class="nav navbar-nav navbar-right" id="barra-menu-derecha">
                <li><a onclick=mostrarLogin()>Iniciar sesión</a></li>
            </ul>
            -->
        </div>
    </div>
</nav>


<div class="container" id="contenedor-principal">

</div>

<script>
    let token;
    let URLbase = "http://localhost:8081/api";

    let contenedorPrincipal = $("#contenedor-principal");

    //Por ahora login por defecto
    mostrarLogin();

    //En caso de token válido se envía al usuario directo a las ofertas disponibles
    if ( Cookies.get('token') !== null ){
        token = Cookies.get('token');
        let url = new URL(window.location.href);
        let w = url.searchParams.get("w");
        if ( w === "login"){
            contenedorPrincipal.load("widget-login.html");
        }
        if ( w === "ofertas"){
            contenedorPrincipal.load("widget-oferta.html");
        }
        if(w === "chat"){
            contenedorPrincipal.load("widget-chat.html");
        }
    }

    function mostrarOfertasAPI() {
        contenedorPrincipal.load("widget-oferta.html");
    }

    function mostrarLogin(){
        contenedorPrincipal.load("widget-login.html");
    }

    /*
    function mostrarConversaciones(){
        contenedorPrincipal.load("widget-conversacion.html");
    }
    */


    function mostrarMisOfertas() {
        contenedorPrincipal.load("widget-productospropios.html");
    }

</script>
</body>
</html>
